<?php

namespace Brasa\ContabilidadBundle\Repository;

use Doctrine\ORM\EntityRepository;

/**
 * CtbImpuestoRepository
 *
 * This class was generated by the Doctrine ORM. Add your own custom
 * repository methods below.
 */
class CtbImpuestoRepository extends EntityRepository
{
     /**
     * Busca los impuestos que coincidan con la descripcion enviada con el parametro
     * @param string $strDescripcion La descripcion del producto a buscar
     * @return query el resultado de la busqueda. 
     */
    public function BuscarDescripcionImpuesto($strNombreImpuesto) {
        try {
            $strNombreImpuesto = str_replace(" ", "%", $strNombreImpuesto);
            
            $em = $this->getEntityManager();
            $query = $em->createQueryBuilder()
                    ->select('impuesto')
                    ->from('BrasaContabilidadBundle:CtbImpuesto', 'impuesto')
                    ->where($em->createQueryBuilder()->expr()->like('impuesto.nombreImpuesto', $em->createQueryBuilder()->expr()->literal('%' . $strNombreImpuesto . '%')))
                    ->orWhere($em->createQueryBuilder()->expr()->like('impuesto.codigoImpuestoPk', $em->createQueryBuilder()->expr()->literal('%' . $strNombreImpuesto . '%')))
                    ->getQuery();
            $arResultado = $query->getResult();
            return $arResultado;
        } catch (Exception $e) {
            return $e;
        }
    }
}